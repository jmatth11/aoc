local helpers = require("utils")
local stack = require("stack")

local function parse_stacks(lines)
    -- TODO implement parsing stacks from array of strings
    local last_line = lines[#lines]
    local crate_stacks = { crates = {} }
    -- iterate through last_line and grab out each number
    for i=(#lines-1), 1, -1 do
        -- reverse iterate through list to add elements on stack
    end
    return crate_stacks
end

local function handle_move(line, context)
    -- TODO implement move
end

local function print_results(context)

end

function Main()
    if #arg < 1 then
        print("must supply an input file")
        return
    end
    local filename = arg[1]
    if not helpers.file_exists(filename) then
        print("file did not exist")
        return
    end
    local stacksParsed = false
    local stackLines = {}
    local context = {stacks = {}}
    for line in io.lines(filename) do
        if not stacksParsed then
            stackLines[#stackLines+1] = line
            if line:match("%d") then
                parse_stacks(stackLines)
                stacksParsed = true
            end
        else
            handle_move(line, context)
        end
    end
    print_results(context)
end

Main()
